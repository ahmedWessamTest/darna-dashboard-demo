<div class="flex justify-content-between items-center mb-4 w-full">
  <h2>Careers Applications</h2>
</div>

<p-table [value]="careerForm" [tableStyle]="{ 'min-width': '50rem' }">
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="id">
        ID
        <p-sortIcon field="id"></p-sortIcon>
      </th>
      <th pSortableColumn="name">
        Name
        <p-sortIcon field="name"></p-sortIcon>
      </th>
      <th pSortableColumn="email">
        Email
        <p-sortIcon field="email"></p-sortIcon>
      </th>
      <th pSortableColumn="phone">
        Phone
        <p-sortIcon field="phone"></p-sortIcon>
      </th>
      <th pSortableColumn="address">
        Address
        <p-sortIcon field="address"></p-sortIcon>
      </th>

      <th pSortableColumn="current_salary">
        Date
        <p-sortIcon field="current_salary"></p-sortIcon>
      </th>
      <th pSortableColumn="expected_salary">
        Expected Salary
        <p-sortIcon field="expected_salary"></p-sortIcon>
      </th>
      <th>View</th>
      <th style="max-width: 50px" pSortableColumn="is_read">
        <div class="flex flex-column gap-2">
          <span>Is Read</span>
          <p-select
            [options]="readStatusOptions"
            [(ngModel)]="selectedReadFilter"
            (ngModelChange)="onReadFilter($event)"
            optionLabel="label"
            optionValue="value"
            [showClear]="true"
            appendTo="body"
            placeholder="Filter by Status" />
        </div>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-career>
    <tr>
      <td>{{ career.id }}</td>
      <td>{{ career.name }}</td>
      <td>{{ career.email }}</td>
      <td>{{ career.phone }}</td>
      <td>{{ career.address }}</td>
      <td>{{ career.career_date }}</td>
      <td>{{ career.expected_salary }}</td>
      <td>
        <a [routerLink]="['view', career.id]">
          <i class="pi pi-eye" style="color: #673ab7"></i>
        </a>
      </td>
      <td>
        <div class="flex align-items-center gap-2">
          <p-toggleswitch
            [ngModel]="returnStatus(career.is_read)"
            (ngModelChange)="onToggleChange(career)"
            [disabled]="isToggleLoading(career.id)" />

          <!-- Loading indicator -->
          @if (isToggleLoading(career.id)) {
          <i
            class="pi pi-spin pi-spinner"
            style="color: #673ab7; font-size: 0.8rem">
          </i>
          }
        </div>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="12" class="text-center p-4">
        <div class="flex flex-column align-items-center justify-content-center">
          <i
            class="pi pi-info-circle"
            style="font-size: 2rem; color: var(--text-color-secondary)"></i>
          <span class="mt-2" style="color: var(--text-color-secondary)"
            >No data found</span
          >
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>
